(function(t){function e(e){for(var s,o,r=e[0],c=e[1],l=e[2],u=0,f=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);d&&d(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],s=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(s=!1)}s&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var s={},i={app:0},a=[];function o(t){return r.p+"js/"+({about:"about"}[t]||t)+"."+{about:"14181373"}[t]+".js"}function r(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var s=new Promise(function(e,s){n=i[t]=[e,s]});e.push(n[2]=s);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,r.nc&&c.setAttribute("nonce",r.nc),c.src=o(t);var l=new Error;a=function(e){c.onerror=c.onload=null,clearTimeout(u);var n=i[t];if(0!==n){if(n){var s=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",l.name="ChunkLoadError",l.type=s,l.request=a,n[1](l)}i[t]=void 0}};var u=setTimeout(function(){a({type:"timeout",target:c})},12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(e)},r.m=t,r.c=s,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/f2e_chat_room/deploy/",r.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var d=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"035c":function(t,e,n){},"2c39":function(t,e,n){"use strict";var s=n("46a5"),i=n.n(s);i.a},"46a5":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[t._v("Home")]),t._v("|\n    "),n("router-link",{attrs:{to:"/about"}},[t._v("About")])],1),n("router-view")],1)},a=[],o=(n("5c0b"),n("2877")),r={},c=Object(o["a"])(r,i,a,!1,null,null,null),l=c.exports,u=n("8c4f"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("iframe",{attrs:{src:"https://www.google.com.tw/",frameborder:"0"}}),n("p",[n("ChatBox",{attrs:{id:t.rollID()}}),n("ChatBox",{attrs:{id:t.rollID()}})],1)])},f=[],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-box",attrs:{id:t.id}},[n("div",{staticClass:"socket-panel",on:{click:t.fold}},[n("div",{staticClass:"stateWrapper"},[n("button",{on:{click:t.reOpenSocket}},[n("i",{staticClass:"fas fa-broadcast-tower",class:{shake:0===t.socketState}})]),0===t.socketState?n("span",{staticClass:"stateString",class:t.socketStateString},[t._v("connecting...")]):1===t.socketState?n("span",{staticClass:"stateString",class:t.socketStateString},[t._v(t._s(t.roomID))]):2===t.socketState?n("span",{staticClass:"stateString",class:t.socketStateString},[t._v("closing")]):3===t.socketState?n("span",{staticClass:"stateString",class:t.socketStateString},[t._v("offline")]):t._e()]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.unreadMsg,expression:"unreadMsg"}],staticClass:"unread-msg"},[t._v("("+t._s(t.unreadMsg)+")")]),n("span",{staticClass:"user-label"},[t._v(t._s(t.user))]),n("button",{staticClass:"fas fa-user-cog setting",on:{click:t.toggleSettingPanel}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isFold,expression:"!isFold"}],staticClass:"main-panel"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showSettingPanel,expression:"showSettingPanel"}],staticClass:"settingPanel"},[n("div",{staticClass:"field username"},[t._m(0),n("div",{staticClass:"input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.user,expression:"user"}],attrs:{type:"text",onclick:"this.focus();this.select()"},domProps:{value:t.user},on:{input:function(e){e.target.composing||(t.user=e.target.value)}}})])]),n("div",{staticClass:"field alert"},[t._m(1),n("div",{staticClass:"input"},[n("span",{class:{selected:t.alert},on:{click:t.turnOnAlert}},[t._v("On")]),n("span",{class:{selected:!t.alert},on:{click:t.turnOffAlert}},[t._v("Mute")])])]),n("div",{staticClass:"field channel"},[t._m(2),n("div",{staticClass:"input"},t._l(t.roomList,function(e){return n("span",{class:{selected:e===t.targetRoomID},on:{click:function(n){return t.changeRoomID(e)}}},[t._v(t._s(e))])}),0)])]),n("div",{staticClass:"msg-panel"},t._l(t.storedData,function(e){return n("MessageBlock",{attrs:{dataObj:e,parentID:t.id},on:{msgAdded:t.scrollToBottom}})}),1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isFold,expression:"!isFold"}],staticClass:"input-panel"},[n("div",{staticClass:"inputs"},[n("button",{on:{click:t.pickFile}},[n("i",{staticClass:"fas fa-paperclip"})]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputContent.textString,expression:"inputContent.textString"}],staticClass:"text-input",attrs:{type:"text",placeholder:"type a message..."},domProps:{value:t.inputContent.textString},on:{keydown:t.keyDownAction,input:function(e){e.target.composing||t.$set(t.inputContent,"textString",e.target.value)}}}),n("input",{staticClass:"file-input",attrs:{type:"file"}}),n("button",{attrs:{disabled:1!=t.socketState},on:{click:t.sendMsg}},[n("i",{staticClass:"far fa-paper-plane"})])]),n("div",{staticClass:"upload-file-preview"},t._l(t.inputContent.files,function(e,s){return n("span",{on:{click:function(e){return t.deleteFile(s)}}},[t._v(t._s(e.name))])}),0)])])},h=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",[n("i",{staticClass:"fas fa-user"}),n("span",[t._v("username")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",[n("i",{staticClass:"fas fa-bell"}),n("span",[t._v("alert")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",[n("i",{staticClass:"fas fa-broadcast-tower"}),n("span",[t._v("channel")])])}],v=(n("6b54"),n("5118"),n("e57f"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"msg-block",class:{self:t.isSelf,notification:"notification"===t.dataObj.type}},["message"===t.dataObj.type?n("div",{staticClass:"messageWrapper"},[t.isSelf?t._e():n("div",{staticClass:"user"},[t._v(t._s(t.dataObj.user))]),n("div",{staticClass:"wrapper"},[n("div",{staticClass:"content"},[t.dataObj.inputContent.files.length?n("div",{staticClass:"files"},t._l(t.dataObj.inputContent.files,function(e){return n("div",{staticClass:"file",domProps:{innerHTML:t._s(t.fileHTML(e.dataUrl))}})}),0):t._e(),t.dataObj.inputContent.textString?n("div",{staticClass:"text"},[t._v(t._s(t.dataObj.inputContent.textString))]):t._e()]),n("div",{staticClass:"time"},[t._v(t._s(t.timeString))])])]):t._e(),"notification"===t.dataObj.type?n("div",[t._v(t._s(t.dataObj.notificationMsg))]):t._e()])}),g=[],m=(n("f559"),{props:{dataObj:{type:Object,required:!0},parentID:{type:String,required:!0}},mounted:function(){this.$emit("msgAdded")},methods:{fileHTML:function(t){return t.startsWith("data:image/")?"<img src='".concat(t,"' alt='image' />"):t.startsWith("data:audio/")?"<audio src='".concat(t,"' controls></audio>"):t.startsWith("data:video/")?"<video src='".concat(t,"' controls></video>"):void 0}},computed:{isSelf:function(){return this.dataObj.id===this.parentID},date:function(){return new Date(this.dataObj.timeStamp)},timeString:function(){var t=String(this.date.getHours()),e=String(this.date.getMinutes());return 0===e.length?e="00":1===e.length&&(e="0"+e),t+":"+e}}}),S=m,b=(n("c54e"),Object(o["a"])(S,v,g,!1,null,null,null)),k=b.exports,C=(n("3c43"),n("bc3a")),_=n.n(C),w={components:{MessageBlock:k},props:{id:{type:String,required:!0}},created:function(){var t=this;this.openSocket(this.roomID),_.a.get("/assets/audio/ping-bing_E_major.wav",{responseType:"blob"}).then(function(e){var n=e.data,s=URL.createObjectURL(n);t.alertSoundURL=s,new Audio(s)}).catch(function(t){console.log(t)})},mounted:function(){var t=this;this.msgPanelDOM=document.querySelector("#".concat(this.id," .msg-panel")),this.fileDOM=document.querySelector("#".concat(this.id," .file-input")),this.fileDOM.onchange=function(e){var n=t.fileDOM.files[0];t.handleFile(n)}},data:function(){return{roomID:"Global",targetRoomID:"Global",roomList:["Global","Food","Music","Movie","Book","Relationship","Job","Vacation"],alert:!0,alertSoundURL:void 0,unreadMsg:0,channelID:"bubblecigar",msgPanelDOM:void 0,fileDOM:void 0,socket:void 0,socketState:void 0,showSettingPanel:!1,inputContent:{textString:"",files:[]},user:"guest",storedData:[],isFold:!0}},computed:{socketStateString:function(){switch(this.socketState){case 0:return"connecting";case 1:return"open";case 2:return"closing";case 3:return"closed";default:throw Error("unexpected socket state")}}},watch:{},methods:{fold:function(t){this.isFold?(this.isFold=!1,this.unreadMsg=0):t.target.classList.contains("socket-panel")&&(this.isFold=!0)},turnOnAlert:function(){this.alert=!0},turnOffAlert:function(){this.alert=!1},changeRoomID:function(t){this.targetRoomID=t,this.reOpenSocket()},toggleSettingPanel:function(){this.showSettingPanel=!this.showSettingPanel},updateSocketState:function(){this.socketState=this.socket.readyState},reOpenSocket:function(){1!==this.socket.readyState&&3!==this.socket.readyState||(this.closeSocket(),this.openSocket(this.targetRoomID))},openSocket:function(t){var e=this;this.socket=new WebSocket("wss://connect.websocket.in/".concat(this.channelID,"?room_id=").concat(t)),this.updateSocketState(),this.socket.onopen=function(n){e.updateSocketState(),e.selfNotification("- you enter ".concat(t," -")),e.sendNotification("- ".concat(e.user," enter ").concat(t," -")),e.roomID=t},this.socket.onclose=function(n){e.selfNotification("- you leave ".concat(t," -")),e.updateSocketState()},this.socket.onmessage=function(t){e.alert&&new Audio(e.alertSoundURL).play().catch(function(t){console.log(t.toString())}),e.isFold&&e.unreadMsg++,e.storeData(t.data)}},closeSocket:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.roomID;this.sendNotification("- ".concat(this.user," leave ").concat(t," -")),this.socket.close(),this.updateSocketState()},deleteFile:function(t){this.inputContent.files.splice(t,1)},scrollToBottom:function(){this.msgPanelDOM&&(this.msgPanelDOM.scrollTop=this.msgPanelDOM.scrollHeight)},keyDownAction:function(t){13===t.keyCode&&this.sendMsg()},emitNotification:function(t){this.selfNotification(t),this.sendNotification(t)},sendNotification:function(t){var e={inputContent:{},user:this.user,id:this.id,timeStamp:Date.now(),type:"notification",notificationMsg:t},n=JSON.stringify(e);1===this.socketState&&this.socket.send(n)},selfNotification:function(t){var e={inputContent:{},user:this.user,id:this.id,timeStamp:Date.now(),type:"notification",notificationMsg:t},n=JSON.stringify(e);this.storeData(n)},sendMsg:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.inputContent;if(1==this.socketState&&(0!==this.inputContent.textString.length||0!==this.inputContent.files.length)){var e={inputContent:this.inputContent,user:this.user,id:this.id,timeStamp:Date.now(),type:"message"},n=JSON.stringify(e);this.socket.send(n),this.storeData(n),this.clearInputContent()}},storeData:function(t){var e=JSON.parse(t);this.storedData.push(e)},clearInputContent:function(){this.inputContent.textString="",this.inputContent.files.splice(0)},handleFile:function(t){var e=this,n=new FileReader;n.onload=function(n){t.dataUrl=n.target.result,e.inputContent.files.push(t)},n.readAsDataURL(t),this.fileDOM.value=""},pickFile:function(){this.fileDOM.click()},createMessageBox:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"received-msg",e=document.createElement("div");return e.classList.add(t),e}}},O=w,y=(n("2c39"),Object(o["a"])(O,p,h,!1,null,null,null)),D=y.exports,M={name:"home",components:{ChatBox:D},methods:{rollID:function(){return"chat-box-"+Math.floor(1e8*Math.random())}}},x=M,j=(n("7c80"),Object(o["a"])(x,d,f,!1,null,"10998ae0",null)),P=j.exports;s["a"].use(u["a"]);var I=new u["a"]({routes:[{path:"/",name:"home",component:P},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"f820"))}}]}),N=n("2f62");s["a"].use(N["a"]);var F=new N["a"].Store({state:{},mutations:{},actions:{}});s["a"].config.productionTip=!1,new s["a"]({router:I,store:F,render:function(t){return t(l)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var s=n("e332"),i=n.n(s);i.a},"7c80":function(t,e,n){"use strict";var s=n("9c60"),i=n.n(s);i.a},"9c60":function(t,e,n){},c54e:function(t,e,n){"use strict";var s=n("035c"),i=n.n(s);i.a},e332:function(t,e,n){}});
//# sourceMappingURL=app.707b8f16.js.map